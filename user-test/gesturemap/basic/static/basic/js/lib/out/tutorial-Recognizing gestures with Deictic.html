<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Tutorial: Recognizing gestures with Deictic | Docs</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/bootstrap.min.css">
    <link type="text/css" rel="stylesheet" href="styles/prettify-jsdoc.css">
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/tui-doc.css">

    
</head>
<body>
<nav class="lnb" id="lnb">
    <div class="logo" style="width: 0px; height: 0px">
        
            <a href="http://dipartimenti.unica.it/matematicaeinformatica/" rel="noopener noreferrer" target="_blank">
                <img src="https://www.unica.it/static/resources/static/img/logo_unica.svg" width="100%" height="100%">
            </a>
        
    </div>
    <div class="title">
        <h1><a href="index.html" class="link">Docs</a></h1>
        
    </div>
    <div class="search-container" id="search-container">
        <input type="text" placeholder="Search">
        <ul></ul>
    </div>
    
        <ol class="lnb-tab">
            <li id="api-tab">
                <a href="#"><h4>API</h4></a>
            </li>
            <li id="examples-tab">
                <a href="#"><h4>Tutorials</h4></a>
            </li>
        </ol>
    
    <div class="lnb-examples hidden"><h3>Tutorials</h3><ul><li><a href="tutorial-Managing the grid map.html">Managing the grid map</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="Managing the grid map_sub"></div></li><li><a href="tutorial-Recognizing gestures with Deictic.html">Recognizing gestures with Deictic</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="Recognizing gestures with Deictic_sub"></div></li><li><a href="tutorial-Recognizing gestures with Finite State Machines.html">Recognizing gestures with Finite State Machines</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="Recognizing gestures with Finite State Machines_sub"></div></li><li><a href="tutorial-Recognizing gestures with Machine Learning.html">Recognizing gestures with Machine Learning</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="Recognizing gestures with Machine Learning_sub"></div></li><li><a href="tutorial-Registering strokes.html">Registering strokes</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="Registering strokes_sub"></div></li><li><a href="tutorial-Using the Octopocus feedback.html">Using the Octopocus feedback</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="Using the Octopocus feedback_sub"></div></li><li><a href="tutorial-Using the line feedback.html">Using the line feedback</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="Using the line feedback_sub"></div></li></ul></div><div class="lnb-api hidden"><h3>Classes</h3><ul><li><a href="Grid.LineFeedback.html">LineFeedback</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="Grid.LineFeedback_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="Grid.LineFeedback.html#layer">layer</a></li><li><a href="Grid.LineFeedback.html#line">line</a></li></ul><div class="member-type">Methods</div><ul class="inner"><li><a href="Grid.LineFeedback.html#addPoint">addPoint</a></li><li><a href="Grid.LineFeedback.html#clearLine">clearLine</a></li><li><a href="Grid.LineFeedback.html#init">init</a></li></ul></div></li><li><a href="Grid.Octopocus.html">Octopocus</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="Grid.Octopocus_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="Grid.Octopocus.html#feedback">feedback</a></li><li><a href="Grid.Octopocus.html#feedforward">feedforward</a></li><li><a href="Grid.Octopocus.html#layer">layer</a></li></ul><div class="member-type">Methods</div><ul class="inner"><li><a href="Grid.Octopocus.html#clear">clear</a></li><li><a href="Grid.Octopocus.html#init">init</a></li><li><a href="Grid.Octopocus.html#start">start</a></li><li><a href="Grid.Octopocus.html#update">update</a></li></ul></div></li><li><a href="Grid.Scene.html">Scene</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="Grid.Scene_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="Grid.Scene.html#imgLayer">imgLayer</a></li><li><a href="Grid.Scene.html#layer">layer</a></li><li><a href="Grid.Scene.html#state">state</a></li></ul><div class="member-type">Methods</div><ul class="inner"><li><a href="Grid.Scene.html#clearCell">clearCell</a></li><li><a href="Grid.Scene.html#init">init</a></li><li><a href="Grid.Scene.html#setMonster">setMonster</a></li><li><a href="Grid.Scene.html#setTreasure">setTreasure</a></li></ul></div></li><li><a href="Input.AngleFSM.html">AngleFSM</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="Input.AngleFSM_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="Input.AngleFSM.html#state">state</a></li><li><a href="Input.AngleFSM.html#states">states</a></li><li><a href="Input.AngleFSM.html#tolerance">tolerance</a></li></ul><div class="member-type">Methods</div><ul class="inner"><li><a href="Input.AngleFSM.html#init">init</a></li><li><a href="Input.AngleFSM.html#push">push</a></li><li><a href="Input.AngleFSM.html#restart">restart</a></li></ul></div></li><li><a href="Input.Deictic.html">Deictic</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="Input.Deictic_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="Input.Deictic.html#eval">eval</a></li><li><a href="Input.Deictic.html#init">init</a></li><li><a href="Input.Deictic.html#recognisedGesture">recognisedGesture</a></li></ul></div></li><li><a href="Input.Event.html">Event</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="Input.Event_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="Input.Event.html#add">add</a></li><li><a href="Input.Event.html#remove">remove</a></li><li><a href="Input.Event.html#trigger">trigger</a></li></ul></div></li><li><a href="Input.MachineLearning.html">MachineLearning</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="Input.MachineLearning_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="Input.MachineLearning.html#eval">eval</a></li><li><a href="Input.MachineLearning.html#init">init</a></li><li><a href="Input.MachineLearning.html#recognisedGesture">recognisedGesture</a></li></ul></div></li><li><a href="Input.Point2D.html">Point2D</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="Input.Point2D_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="Input.Point2D.html#x">x</a></li><li><a href="Input.Point2D.html#y">y</a></li></ul></div></li><li><a href="Input.StrokeInput.html">StrokeInput</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="Input.StrokeInput_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="Input.StrokeInput.html#onStrokeBegin">onStrokeBegin</a></li><li><a href="Input.StrokeInput.html#onStrokeChange">onStrokeChange</a></li><li><a href="Input.StrokeInput.html#onStrokeEnd">onStrokeEnd</a></li></ul></div></li></ul></div><div class="lnb-api hidden"><h3>Namespaces</h3><ul><li><a href="Grid.html">Grid</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="Grid_sub"><div class="member-type">Typedef</div><ul class="inner"><li><a href="Grid.html#~Feedforward">Feedforward</a></li><li><a href="Grid.html#~FeedforwardState">FeedforwardState</a></li></ul></div></li><li><a href="Input.html">Input</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="Input_sub"><div class="member-type">Typedef</div><ul class="inner"><li><a href="Input.html#~AngleFSMState">AngleFSMState</a></li><li><a href="Input.html#~DeicticEvaluation">DeicticEvaluation</a></li><li><a href="Input.html#~DeicticEvaluationPart">DeicticEvaluationPart</a></li><li><a href="Input.html#~DeicticGesture">DeicticGesture</a></li><li><a href="Input.html#~DollarSamples">DollarSamples</a></li><li><a href="Input.html#~DollarTraining">DollarTraining</a></li><li><a href="Input.html#~MLEvaluation">MLEvaluation</a></li><li><a href="Input.html#~StrokeChangeDescriptor">StrokeChangeDescriptor</a></li></ul></div></li></ul></div>
</nav>
<div id="resizer"></div>

<div class="main" id="main">
    

<section>
    <header>
        

        <h2>Recognizing gestures with Deictic</h2>
    </header>

    
        <article class="readme">
            <h1>Recognizing gestures with Deictic</h1><p>Deictic exploits a combination of declarative gesture modelling (i.e. through expression) and Machine Learning for 
supporting a robust but rapidly configurable gesture recognition. The developer models the stroke gestures through
expression composing simple 2D geometric primitives. The underlying recognition engines creates the classifier and 
trains it generating the gesture samples from the those collected for the geometric primitives and shipped with the
library. During the recognition, it provides information on the recognition of the whole gesture and its sub-parts 
as defined by the gesture expression. </p>
<p>In this test, the class <a href="Input.Deictic.html">Input.Deictic</a> object provides a simple API for defining and recognizing gestures with 
the Deictic approach. Please note that the recognition is currently performed at server-side for technical reasons. </p>
<h2>Defining the gesture models</h2><p>Defining gestures stroke with Deictic requires using a simple expression language. The basic ingredients are a set
of simple geometric primitives, depicted in the following figure (please note that the Y positive direction is up,
as in Cartesian coordinates and opposite to the screen coordinates). A 
<a href="http://localhost:8000/basic/deictic_editor" target="_blank">
graphical modelling editor</a> for the expressions is available. </p>
<p><img src="./tutorials/img/6-1-primitives.png" alt="A sample grid map" style="width: 600px;"/> </p>
<ul>
<li>A <strong>2D point</strong>, denoted as <code>P(x,y)</code> where <code>x</code> and <code>y</code> are its coordinates. 
It represents the starting point of a stroke.</li>
<li>A <strong>2D line</strong>, starting at the end of the previous primitive and moving <code>dx</code> along the X
axis and <code>dy</code> along the Y axis, denoted as <code>L(dx, dy)</code>. It represents a movement along a linear path.</li>
<li>A <strong>2D arc</strong>, starting at the end of the previous primitive, moving <code>dx</code> along the X 
axis and <code>dy</code> along the Y axis, clockwise if <code>cw === true</code> or counter-clockwise if <code>cw === false</code>. 
An arc is denoted as <code>A(dx, dy, cw)</code>. It represents a movement along a curved path, clockwise or counterclockwise.</li>
</ul>
<p>Starting from these primitives we can obtain complex gestures composing them through the following operators:</p>
<ul>
<li>A <strong>sequence</strong>, represented by the symbol <code>+</code>, indicating that the the user has to complete first the left 
operand and then the right one.  <code>A + B</code> denotes that, for completing the gesture, the user has first to 
perform <code>A</code>and then <code>B</code></li>
<li>A <strong>choice</strong>, represented by the symbol <code>|</code>, indicating that the user has to complete either one operand or the other. 
<code>A | B</code> denotes that, for completing the gesture, the user may perform either <code>A</code> or <code>B</code></li>
<li>A <strong>parallel</strong> execution, represented by the symbol <code>*</code>, indicating that the user has to complete either both 
operands at (nearly) the same time. <code>A * B</code> denotes that, for completing the gesture, the user has to perform both 
<code>A</code> and <code>B</code>  </li>
</ul>
<p>A stroke always stars with a point. Then, it continues along a linear (line), curved (arc) or mixed  (both of them) path. 
A multi-stroke gesture (e.g. performed with more than a finger) contains two or more point primitives. </p>
<p>Please note that only the relative sizes among the primitives influence the recognition, since the dimensions are 
normalised by the underlying engine. 
Therefore the gesture <code>P(0,0) + L(0,1) + L(1,0)</code> is equivalent to <code>P(0,0) + L(0,5) + L(5,0)</code>, but it is different from 
<code>P(0,0) + L(0,1) + L(5,0)</code>, since the movement on the X  is 5 times the one on the Y.</p>
<p>The following are some modelling examples.</p>
<ul>
<li><a href="./tutorials/img/6-2-horizontal.png" target="_blank">
  <img src="./tutorials/img/6-2-horizontal.png" alt="" style="width: 150px;"/>
 </a> Horizontal line: <code>P(0,0) + L(5, 0)</code></li>
<li><a href="./tutorials/img/6-3-vertical.png" target="_blank">
  <img src="./tutorials/img/6-3-vertical.png" alt="" style="width: 150px;"/> 
</a>Vertical line: <code>P(0,0) + L(0, 5)</code></li>
<li><a href="./tutorials/img/6-4-v.png" target="_blank">
 <img src="./tutorials/img/6-4-v.png" alt="" style="width: 150px;"/> 
</a> V: <code>P(0,0) + L(2,-3) + L(2,3)</code></li>
<li><a href="./tutorials/img/6-5-circle-cw.png" target="_blank">
  <img src="./tutorials/img/6-5-circle-cw.png" alt="" style="width: 150px;"/> 
</a> Clockwise circle: <code>P(0, 0) + A(3, -3, true) + A(-3, -3, true) + A(-3, 3, true) + A(3, 3, true)</code></li>
<li><a href="./tutorials/img/6-6-circle-ccw.png" target="_blank">
  <img src="./tutorials/img/6-6-circle-ccw.png" alt="" style="width: 150px;"/>
</a>Counter-clockwise circle: <code>P(0, 0) + A(-3, -3, false) + A(3, -3, false) + A(3, 3, false) + A(-3, 3, false)</code></li>
<li><a href="./tutorials/img/6-7-question.png" target="_blank">
  <img src="./tutorials/img/6-7-question.png" alt="" style="width: 150px;"/> 
</a> Question mark: <code>P(0,0) + A(3,3, true) + A(3,-3, true) + A(-3,-3,true) + L(0,-4)</code></li>
<li><a href="./tutorials/img/6-8-star.png" target="_blank">
   <img src="./tutorials/img/6-8-star.png" alt="" style="width: 150px;"/> 
 </a> Star: <code>P(0,0) + L(2,5) + L(2, -5) + L(-5, 3) + L(6,0) + L(-5, -3)</code></li>
</ul>
<h2>Deictic initialization</h2><p>The <a href="Input.Deictic.html">Input.Deictic</a> class allows defining the gestures used in the application through the expression described
in the previous section. At the initialization step, we specify the expressions as string in the configuration object 
(an array of <a href="Input.html#~DeicticGesture">Input~DeicticGesture</a>),
providing a name for each of them. The following code initializes a  <a href="Input.Deictic.html">Input.Deictic</a> with the V and the 
counter-clockwise circle from the examples above.  Internally, the function communicates with the server-side part and
automatically trains the recognizer according to the gesture set. This step may take some time to complete (5-6 seconds). </p>
<p>A <a href="http://localhost:8000/basic/deictic_editor" target="_blank">
graphical modelling editor</a> for the gesture expressions is available. </p>
<pre class="prettyprint source"><code>var deictic = new Input.Deictic();
// configures deictic for recognizing a V and a circle gesture (counter-clockwise)
deictic.init([
     {name: 'V', model: 'P(0,0) + L(2,-3) + L(2,3)'},
     {name: 'circle', model: 'P(0, 0) + A(-3, -3, false) + A(3, -3, false) + A(3, 3, false) + A(-3, 3, false)'}
]);</code></pre><h2>Gesture recognition</h2><p>Once the initialization, the <code>deictic</code> object is able to evaluate the stroke performance, assigning probabilities to 
both the recognition of the entire gesture and of its sub-parts. In order perform this evaluation, we 
call the <code>eval</code> method, which requires the entire history of the stroke. When we use the <a href="Input.Deictic.html">Input.Deictic</a> class 
in combination with the <a href="Input.StrokeInput.html">Input.StrokeInput</a>, we need only to access the <code>event.d.buffer</code> array.</p>
<pre class="prettyprint source"><code>// When receiving an update from the StrokeInput input,
// we evaluate it with Deictic. The object input is an
// Input.StrokeInput instance.
input.onStrokeChange.add(function (event) {
    var result = deictic.eval(event.d.buffer);

    // check the probability of the second part of the V gesture
    var prob = 0;
    for(var i in result){
         var gesture = result[i];
         if(gesture.name === 'V'){
             prob = gesture.parts[1].probability;
         }
    }
});</code></pre><p>The <code>result</code> returned by the <code>evaluation</code> method is an array of <a href="Input.html#~DeicticEvaluation">Input~DeicticEvaluation</a> objects. Each entry
has two properties:</p>
<ol>
<li>a <code>name</code> the name a gesture, as specified in the <code>init</code> method</li>
<li>a <code>parts</code> array, that contains the probability associated to each gesture part. Each element of this array contains:<ol>
<li>the part <code>name</code>, corresponding to the expression corresponding to the sub-part</li>
<li>the <code>probability</code>, corresponding to the recognition likelihood associated to the the sub-part</li>
</ol>
</li>
</ol>
<p>The following is a sample dump of a possible <code>eval</code> output. Please notice that:</p>
<ol>
<li>The parts are ordered according to the temporal sequence used in the gesture definition.</li>
<li>The probability of the recognition of an entire gesture is specified in the last entry of its parts array.</li>
<li>During the recognition, the probability of a given part (e.g. the first of the V gesture), may be higher than the
the entire gesture recognition probability. This means that the underlying recognition algorithm believes that the 
user is performing an <strong>intermediate part of the gesture</strong>. </li>
</ol>
<pre class="prettyprint source"><code>[
     name: 'V', parts: [
         {name: 'P(0,0) + L(2,-3)', probability: 0.33},
         {name: 'P(0,0) + L(2,-3) + L(2,3)', probability: 0.75}
     ],

     name: 'circleCw', parts: [
         {name: 'P(0, 0) + A(3, 3, true)', probability: 0},
         {name: 'P(0, 0) + A(3, 3, true) + A(3, -3, true)', probability: 0},
         {name: 'P(0, 0) + A(3, 3, true) + A(3, -3, true) + A(-3, -3, true)', probability: 0},
         {name: 'P(0, 0) + A(3, 3, true) + A(3, -3, true) + A(-3, -3, true) + A(-3, 3, true)', probability: 0},
     ]
]</code></pre><p>In many cases, we consider as the recognized gesture the one having the higher probability. In addition, we threshold
its probability value in order to avoid low values. For instance, if the maximum probability is 0.25 we consider the
not recognized. The <a href="Input.Deictic.html">Input.Deictic</a> object provides the <code>recognizedGesture</code> utility method for searching 
the maximum probability and threshold it.  The method takes as input the object returned by <code>eval</code>.</p>
<pre class="prettyprint source"><code>// get the most likely gesture at the end of the stroke performance.
// input is an Input.StrokeInput instance
input.onStrokeEnd.add(function (event) {
    var gesture = deictic.recognizedGesture(deictic.eval(event.d.buffer), 0.70);

});</code></pre>
        </article>
    
</section>



</div>

<footer>
    <img class="logo" src="https://www.unica.it/static/resources/static/img/logo_unica.svg" style="width: 0px; height: 0px">
    <div class="footer-text">Gesture UI Development Test</div>
</footer>
<script>prettyPrint();</script>
<script src="scripts/jquery.min.js"></script>
<script src="scripts/tui-doc.js"></script>
<script src="scripts/linenumber.js"></script>

    <script>
        showLnbExamples();
    </script>

</body>
</html>